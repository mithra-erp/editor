<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css"
        integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi" crossorigin="anonymous">
    <!-- Include stylesheet -->
    <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
    <title>Document</title>
    <style>
        #editor {
            height: 350px;
        }
    </style>
</head>

<body>
    <div class="container-fluid p-2 h-100">
        <div class="input-group mt-2 mb-2">
            <div class="input-group-text">Id da Campanha</div>
            <input type="text" class="form-control" id="chave">
            <button type="button" class="btn btn-primary btn-sm align-bottom" onclick="teste()">Salvar Campanha</button>
        </div>
        <!-- Create toolbar container -->
        <div class="quill-wrapper" class="m-2">
            <div id="toolbar">
                <span class="ql-formats">
                    <select class="ql-font"></select>
                    <select class="ql-size"></select>
                </span>
                <span class="ql-formats">
                    <button class="ql-bold"></button>
                    <button class="ql-italic"></button>
                    <button class="ql-underline"></button>
                    <button class="ql-strike"></button>
                </span>
                <span class="ql-formats">
                    <select class="ql-color"></select>
                    <select class="ql-background"></select>
                </span>
                <span class="ql-formats">
                    <button class="ql-script" value="sub"></button>
                    <button class="ql-script" value="super"></button>
                </span>
                <span class="ql-formats">
                    <button class="ql-header" value="1"></button>
                    <button class="ql-header" value="2"></button>
                    <button class="ql-blockquote"></button>
                    <button class="ql-code-block"></button>
                </span>
                <span class="ql-formats">
                    <button class="ql-list" value="ordered"></button>
                    <button class="ql-list" value="bullet"></button>
                    <button class="ql-indent" value="-1"></button>
                    <button class="ql-indent" value="+1"></button>
                </span>
                <span class="ql-formats">
                    <button class="ql-direction" value="rtl"></button>
                    <select class="ql-align"></select>
                </span>
                <span class="ql-formats">
                    <button class="ql-link"></button>
                    <button class="ql-image"></button>
                    <button class="ql-video"></button>
                    <button class="ql-formula"></button>
                </span>
                <span class="ql-formats">
                    <button class="ql-clean"></button>
                </span>
            </div>

            <!-- Create the editor container -->
            <div id="editor" spellcheck="false">
                <p>Hello World!</p>
                <p>Some initial <strong>bold</strong> text</p>
                <p><br></p>
            </div>
        </div>
        <!-- Include the Quill library -->
        <script src="quill.js"></script>
        <script src="image-resize.min.js"></script>
        <!-- Initialize Quill editor -->
        <script>
            var quill = new Quill('#editor', {
                theme: 'snow',
                modules: {
                    imageResize: {
                        displaySize: true // default false
                    },
                    toolbar: '#toolbar'
                }
            });

            const teste = () => {
                let content = document.querySelector('.ql-editor').innerHTML;
                alert('enviar');
                window.fetch("https://api.mithra.com.br/mithra/v1/template", {
                    headers: {
                        "Authorization": `Bearer ${sessionStorage.getItem('access_token')}`,
                        "X-Client-id": sessionStorage.getItem('x-client-id')
                    },
                    method: "POST",
                    body: JSON.stringify([{
                        area: 'LAYOUT',
                        data: [
                            {
                                CHAVE: 'CHAVET',
                                TEXTO: content
                            }
                        ]
                    }])
                }).then(async (result) => {
                    let response = await result.json();
                    console.log(response)
                    if (result.ok) {
                        window.close();
                    } else {
                        alert(response.message);
                    }
                }).catch((result) =>
                    console.log(result)
                )
            }

            //document.querySelector('#auth').value = '" + hRetorno["access_token"] + "';
        </script>
</body>

</html>